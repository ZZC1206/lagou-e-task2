# å‚è€ƒèµ„æ–™ï¼š

## vue-loader:

â€‹		https://vue-loader.vuejs.org/zh/

â€‹		ä¸»è¦å‚è€ƒ **vue** æ‰“åŒ…

## webpack:

â€‹		https://webpack.docschina.org/

â€‹		ä¸»è¦å‚è€ƒ **webpack** æ‰“åŒ…é…ç½®

## npm:

â€‹		https://www.npmjs.com/

â€‹		ä¸»è¦å‚è€ƒ **å„ç§ loader å’Œ Plugin** ä½¿ç”¨å’Œé…ç½®ï¼Œç‰ˆæœ¬ä¿¡æ¯æµè§ˆ



# å®‰è£…ç›¸å…³ä¾èµ–

###  å®‰è£… **webpack** ç›¸å…³ä¾èµ–

```cmd
npm i -D webpack@4.46.0 webpack-cli@3 webpack-dev-server serve
```

### å®‰è£… **vue** ç›¸å…³ä¾èµ–

```cmd
npm i -g @vue/cli

npm i -D vue-loader@15 vue-template-compiler vue-style-loader
```

### å®‰è£… **html** ç›¸å…³ä¾èµ–

```cmd
npm i -D html-webpack-plugin@4.5.2 --force
```

### å®‰è£… **css** ç›¸å…³ä¾èµ–

```cmd
npm i -D style-loader css-loader@3.6.0 less-loader less
```



### å®‰è£… **æ–‡ä»¶èµ„æº** ç›¸å…³ä¾èµ–

```npm
npm i -D url-loader file-loader copy-webpack-plugin
```



### å®‰è£… **js** ç›¸å…³ä¾èµ–

```cmd
npm i -D babel-loader babel-eslint @babel/core @vue/cli-plugin-babel babel-preset-env

npm i -D babel-loader@7.1.5 babel-core@6.26.3
```





# 1. å®ç°config.jsæ‰“åŒ…

## ä¸€ã€å‚ç…§ vue-loader å®˜ç½‘æ‰“åŒ…

### 1ã€ä½¿ç”¨å®˜ç½‘ä¾‹å­

#### webpack.config.js [æºç ä¾‹å­](https://vue-loader.vuejs.org/zh/guide/#%E6%89%8B%E5%8A%A8%E8%AE%BE%E7%BD%AE)

```js
// webpack.config.js
const { VueLoaderPlugin } = require('vue-loader')

module.exports = {
    // æ‰“åŒ…æ¨¡å¼
    mode: 'development', 

    // ä¸åŒç±»å‹æ¨¡å—çš„å¤„ç†è§„åˆ™
    module: {
        rules: [
            {
                test: /\.vue$/,
                loader: 'vue-loader'
            },
            // å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.js` æ–‡ä»¶
            // ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<script>` å—
            {
                test: /\.js$/,
                loader: 'babel-loader'
            },
            // å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.css` æ–‡ä»¶
            // ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<style>` å—
            {
                test: /\.css$/,
                use: [
                    'vue-style-loader',
                    'css-loader'
                ]
            }
        ]
    },
    plugins: [
        // è¯·ç¡®ä¿å¼•å…¥è¿™ä¸ªæ’ä»¶æ¥æ–½å±•é­”æ³•
        new VueLoaderPlugin()
    ]
}
```

â€‹		æˆ‘ä»¬éœ€è¦å®‰è£…ç›¸å…³ **loader**ï¼š**vue-loader**ã€**babel-loader**ã€**vue-style-loader**ã€**css-loader**ï¼Œæš‚æ—¶å…ˆè¿™æ ·ã€‚

#### æµ‹è¯•ğŸŒ°

```cmd
webpack -c webpack.config.js
```

#### â˜…æŠ¥é”™å¤„ç†â˜…

##### 1ã€Error: vue-loader requires @vue/compiler-sfc to be present in the dependency tree.

ç°åœ¨å®‰è£…çš„ **vue-loader** æ˜¯çš„ **16**ç‰ˆæœ¬çš„ï¼Œç‰ˆæœ¬å¤ªé«˜äº†ã€‚

```cmd
npm i -D vue-loader@14 --force
```

##### 2ã€Error: Cannot find module 'vue-template-compiler'

éœ€è¦å®‰è£… **vue-template-compiler** æ¨¡å—

```cmd
npm i -D vue-template-compiler
```

##### 3ã€Error: Cannot find module '@babel/core'

éœ€è¦å®‰è£… **babel-core** 

```cmd
npm i -D babel-loader@7.1.5 babel-core@6.26.3
```

##### 4ã€TypeError: VueLoaderPlugin is not a constructor

ä¸ºäº†ç¡®ä¿ä¸ä¼šåŒ…åˆ«çš„é”™è¯¯ï¼Œå…ˆå…¨å±€å®‰è£… **@vue/cli**

```cmd
npm i -g @vue/cli
```

å†å®‰è£… **vue-loader**

```cmd
npm i -D vue-loader@15 --force
```

##### 5ã€ERROR in Entry module not found: Error: Can't resolve './src' in 'xxxx'

å› ä¸º **vue** æ¨¡æ¿å…¥å£æ–‡ä»¶æ˜¯çš„ **mian.js**ï¼Œ **webpack.config.js** éœ€è¦è®¾ç½®æŒ‡å®šçš„å…¥å£æ–‡ä»¶

```js
module.exports={
    mode: 'development',

    // Webpack å…¥å£æ–‡ä»¶, å•ä¸ªå…¥å£ stringï¼Œå¤šä¸ªå…¥å£ï½›ï½
    entry: './src/main.js', // å…¥å£æ–‡ä»¶

    module: {}
}
```

##### 6ã€ReferenceError: Unknown plugin "transform-es2015-modules-commonjs" specified in 'XXX'

éœ€è¦å®‰è£… **babel-plugin-transform-es2015-modules-commonjs** æ’ä»¶

```cmd
npm i -D babel-plugin-transform-es2015-modules-commonjs
```

##### 7ã€ERROR in ./xxxxx=css& (./node_modules/css-loader/dist/cjs.js! .... /cjs.js):TypeError: this.getOptions is not a function at Object.loader

**css-loader** ç‰ˆæœ¬è¿‡é«˜

```
npm i -D css-loader@3.6.0 --force
```

##### 8ã€ERROR in ./src/assets/logo.png 1:0Module parse failed: Unexpected character 'ï¿½' (1:0)

æ²¡æœ‰é…ç½®å¤„ç†å›¾ç‰‡èµ„æºæ¨¡å—è§„åˆ™ï¼Œ

å…ˆå®‰è£… **url-loader** å’Œ **file-loader**

```cmd
npm i -D url-loader file-loader
```

**webpack.config.js**

```js
module:{
    rules:[
        ...
        {
                test: /\.(png|svg|jpg|jpeg|gif)$/,
                loader: 'url-loader',
                options: {
                    name: 'img/[name].[hash:10].[ext]', // æ–‡ä»¶åå­—
                    limit: 5 * 1024, // å¤§å°é™åˆ¶ 5kbï¼Œè¶…å‡ºäº† ç”¨ file-loader å¤„ç†
                    esModule: false, // webpackæ‰“åŒ…å html ä¸­çš„ imgæ ‡ç­¾ çš„ srcå±æ€§æˆäº†[object_Module]ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŠ è½½å™¨ç”Ÿæˆä½¿ç”¨ES modulesè¯­æ³•çš„JSæ¨¡å—ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½¿ç”¨ESæ¨¡å—æ˜¯æœ‰ç›Šçš„ï¼Œä¾‹å¦‚åœ¨ module concatenation å’Œt ree- shaking çš„æƒ…å†µä¸‹ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å¯ç”¨CommonJSæ¨¡å—è¯­æ³•
                },
            },
    ]
}
```

#### å®Œæ•´çš„webpack.config.js

```js
// webpack.config.js
const { VueLoaderPlugin } = require('vue-loader')

module.exports = {
    // æ‰“åŒ…æ¨¡å¼
    mode: 'development',

    // Webpack å…¥å£æ–‡ä»¶, å•ä¸ªå…¥å£ stringï¼Œå¤šä¸ªå…¥å£ï½›ï½
    entry: './src/main.js', // å…¥å£æ–‡ä»¶

    // ä¸åŒç±»å‹æ¨¡å—çš„å¤„ç†è§„åˆ™
    module: {
        rules: [
            {
                test: /\.vue$/,
                loader: 'vue-loader'
            },
            // å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.js` æ–‡ä»¶
            // ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<script>` å—
            {
                test: /\.js$/,
                loader: 'babel-loader'
            },
            // å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.css` æ–‡ä»¶
            // ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<style>` å— 4.3.0
            {
                test: /\.css$/,
                use: [
                    'vue-style-loader',
                    'css-loader'
                ]
            },
            {
                test: /\.(png|svg|jpg|jpeg|gif)$/,
                loader: 'url-loader',
                options: {
                    name: 'img/[name].[hash:10].[ext]', // æ–‡ä»¶åå­—
                    limit: 5 * 1024, // å¤§å°é™åˆ¶ 5kbï¼Œè¶…å‡ºäº† ç”¨ file-loader å¤„ç†
                    esModule: false, // webpackæ‰“åŒ…å html ä¸­çš„ imgæ ‡ç­¾ çš„ srcå±æ€§æˆäº†[object_Module]
                   // é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŠ è½½å™¨ç”Ÿæˆä½¿ç”¨ES modulesè¯­æ³•çš„JSæ¨¡å—ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½¿ç”¨ESæ¨¡å—æ˜¯æœ‰ç›Šçš„ï¼Œä¾‹å¦‚åœ¨ module concatenation å’Œt ree- shaking çš„æƒ…å†µä¸‹ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å¯ç”¨CommonJSæ¨¡å—è¯­æ³•
                },
            },
        ]
    },
    plugins: [
        // è¯·ç¡®ä¿å¼•å…¥è¿™ä¸ªæ’ä»¶æ¥æ–½å±•é­”æ³•
        new VueLoaderPlugin()
    ]
}
```

æ‰§è¡Œååˆ©æµ‹è¯•ï¼Œå°±ä¼šåœ¨æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª **dist** æ–‡ä»¶



### 2ã€å¢åŠ HtmlWebpackPluginå’ŒCopyWebpackPlugin

å®‰è£…HtmlWebpackPlugin

```cmd
npm i -D html-webpack-plugin copy-webpack-plugin
```



#### å®Œæ•´webpack.config.js

```js
// webpack.config.js
const path = require('path')
const VueLoaderPlugin = require('vue-loader/lib/plugin')
const HtmlWebpackPlugin = require('html-webpack-plugin')
const CopyWebpackPlugin = require('copy-webpack-plugin')

module.exports = {
    // æ‰“åŒ…æ¨¡å¼
    mode: 'development',

    // Webpack å…¥å£æ–‡ä»¶, å•ä¸ªå…¥å£ stringï¼Œå¤šä¸ªå…¥å£ï½›ï½
    entry: './src/main.js', // å…¥å£æ–‡ä»¶

    // æŒ‡å®šè¾“å‡ºæ–‡ä»¶ç›®å½•
    output: {
        // æŒ‡å®šè¾“å‡ºæ–‡ä»¶ç›®å½•
        filename: 'js/[name].bundle.js',
        path: path.resolve(__dirname, 'dist'), // nodeè¯­æ³•ï¼Œ__dirname è·å–å½“å‰æ–‡ä»¶çš„è·¯å¾„
    },

    // ä¸åŒç±»å‹æ¨¡å—çš„å¤„ç†è§„åˆ™
    module: {
        rules: [
            {
                test: /\.vue$/,
                loader: 'vue-loader'
            },
            // å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.js` æ–‡ä»¶
            // ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<script>` å—
            {
                test: /\.js$/,
                loader: 'babel-loader'
            },
            // å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.css` æ–‡ä»¶
            // ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<style>` å— 4.3.0
            {
                test: /\.css$/,
                use: [
                    'vue-style-loader',
                    'css-loader'
                ]
            },
            {
                test: /\.(png|svg|jpg|jpeg|gif)$/,
                loader: 'url-loader',
                options: {
                    name: 'img/[name].[hash:10].[ext]', // æ–‡ä»¶åå­—
                    limit: 5 * 1024, // å¤§å°é™åˆ¶ 5kbï¼Œè¶…å‡ºäº† ç”¨ file-loader å¤„ç†
                    esModule: false, // webpackæ‰“åŒ…å html ä¸­çš„ imgæ ‡ç­¾ çš„ srcå±æ€§æˆäº†[object_Module]
                    // é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŠ è½½å™¨ç”Ÿæˆä½¿ç”¨ES modulesè¯­æ³•çš„JSæ¨¡å—ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½¿ç”¨ESæ¨¡å—æ˜¯æœ‰ç›Šçš„ï¼Œä¾‹å¦‚åœ¨ module concatenation å’Œt ree- shaking çš„æƒ…å†µä¸‹ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å¯ç”¨CommonJSæ¨¡å—è¯­æ³•
                },
            },
        ]
    },
    plugins: [
        // è¯·ç¡®ä¿å¼•å…¥è¿™ä¸ªæ’ä»¶æ¥æ–½å±•é­”æ³•
        new VueLoaderPlugin(),
        new HtmlWebpackPlugin({
            title: 'App',
            // favicon: "./public/favicon.ico", // åœ¨æ­¤å¤„è®¾ç½®
            template: './public/index.html',
        }),
        new CopyWebpackPlugin(['public'])
    ]
}
```

#### â˜…æŠ¥é”™å¤„ç†â˜…

##### 1ã€throw err;TypeError: Cannot read property 'tap' of undefined at HtmlWebpackPlugin.apply

HtmlWebpackPluginç‰ˆæœ¬è¿‡é«˜

```
npm i -D html-webpack-plugin@4.5.2 --force
```

##### 2ã€Invalid options object. Copy Plugin has been initialized using an options object that does not match the API schema.options[0] should be an object:object { patterns, options? }ValidationError: Invalid options object. Copy Plugin has been initialized using an options object that does not match the API schema. at validate

copy-webpack-plugin ç‰ˆæœ¬è¿‡é«˜

```cmd
npm i -D copy-webpack-plugin@5.1.2 --force
```

#### æµ‹è¯•ğŸŒ°

```cmd
webpack -c webpack.config.js
```

æ‰§è¡Œå‘½ä»¤æµ‹è¯•ï¼Œå°±ä¼šåœ¨æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª **dist** æ–‡ä»¶ï¼Œè·Ÿä¹‹å‰çš„ç›¸æ¯”é‡Œé¢å¤šå‡ºäº† **htmlç­‰æ–‡ä»¶**ï¼Œä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ **html** ï¼Œèƒ½æ­£å¸¸é¢„è§ˆã€‚

### 3ã€æ€»ç»“

â€‹		è¿™æ˜¯å·²ç»å®Œæˆäº†é¡¹ç›®çš„åŸºæœ¬æ‰“åŒ…äº†ã€‚



# 2.ä¸åŒç¯å¢ƒä¸‹çš„é…ç½®

## ä¸€ã€å‰è¨€

â€‹		**development(å¼€å‘ç¯å¢ƒ)** å’Œ **production(ç”Ÿäº§ç¯å¢ƒ)** è¿™ä¸¤ä¸ªç¯å¢ƒä¸‹çš„æ„å»ºç›®æ ‡å­˜åœ¨ç€å·¨å¤§å·®å¼‚ã€‚åœ¨**å¼€å‘ç¯å¢ƒ**ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ï¼šå¼ºå¤§çš„ source map å’Œä¸€ä¸ªæœ‰ç€ live reloading(å®æ—¶é‡æ–°åŠ è½½) æˆ– hot module replacement(çƒ­æ¨¡å—æ›¿æ¢) èƒ½åŠ›çš„ localhost serverã€‚è€Œ**ç”Ÿäº§ç¯å¢ƒ**ç›®æ ‡åˆ™è½¬ç§»è‡³å…¶ä»–æ–¹é¢ï¼Œå…³æ³¨ç‚¹åœ¨äºå‹ç¼© bundleã€æ›´è½»é‡çš„ source mapã€èµ„æºä¼˜åŒ–ç­‰ï¼Œé€šè¿‡è¿™äº›ä¼˜åŒ–æ–¹å¼æ”¹å–„åŠ è½½æ—¶é—´ã€‚ç”±äºè¦éµå¾ªé€»è¾‘åˆ†ç¦»ï¼Œæˆ‘ä»¬é€šå¸¸å»ºè®®ä¸ºæ¯ä¸ªç¯å¢ƒç¼–å†™**å½¼æ­¤ç‹¬ç«‹çš„ webpack é…ç½®**ã€‚

â€‹		è™½ç„¶ï¼Œä»¥ä¸Šæˆ‘ä»¬å°† *ç”Ÿäº§ç¯å¢ƒ* å’Œ *å¼€å‘ç¯å¢ƒ* åšäº†ç»†å¾®åŒºåˆ†ï¼Œä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šéµå¾ªä¸é‡å¤åŸåˆ™(Don't repeat yourself - DRY)ï¼Œä¿ç•™ä¸€ä¸ª "common(é€šç”¨)" é…ç½®ã€‚ä¸ºäº†å°†è¿™äº›é…ç½®åˆå¹¶åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸º [`webpack-merge`](https://github.com/survivejs/webpack-merge) çš„å·¥å…·ã€‚æ­¤å·¥å…·ä¼šå¼•ç”¨ "common" é…ç½®ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…å†åœ¨ç¯å¢ƒç‰¹å®š(environment-specific)çš„é…ç½®ä¸­ç¼–å†™é‡å¤ä»£ç ã€‚

â€‹		å®‰è£… `webpack-merge` 

```bash
npm install -D webpack-merge
```

**project**

```diff
  webpack-demo
  |- package.json
- |- webpack.config.js
+ |- webpack.common.js
+ |- webpack.dev.js
+ |- webpack.prod.js
  |- /dist
  |- /src
    |- index.js
    |- math.js
  |- /node_modules
```

(æºï¼š[webpackå®˜ç½‘](https://webpack.docschina.org/guides/production/#setup) )

â€‹		è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½œä¸šé¡¹ç›®ä¸‹æ²¡æœ‰ **webapck.config.js** ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯çš„ **webpack.common.js**ã€**webpack.dev.js**ã€**webpack.prod.js** ä¸‰ä¸ªé…ç½®æ–‡ä»¶ã€‚



## äºŒã€å¼€å‘ç¯å¢ƒé…ç½®æ‰“åŒ…

å…ˆå®‰è£… **webpack-dev-server**

```cmd
npm i -D webpack-dev-server webpack-merge
```

### webpack.common.js

æŠŠ **CopyWebpackPlugin** ç§»é™¤äº†

```js
// webpack.config.js
const path = require('path')
const VueLoaderPlugin = require('vue-loader/lib/plugin')
const HtmlWebpackPlugin = require('html-webpack-plugin')

module.exports = {
    // æ‰“åŒ…æ¨¡å¼
    mode: 'development',

    // Webpack å…¥å£æ–‡ä»¶, å•ä¸ªå…¥å£ stringï¼Œå¤šä¸ªå…¥å£ï½›ï½
    entry: './src/main.js', // å…¥å£æ–‡ä»¶

    // æŒ‡å®šè¾“å‡ºæ–‡ä»¶ç›®å½•
    output: {
        // æŒ‡å®šè¾“å‡ºæ–‡ä»¶ç›®å½•
        filename: 'js/[name].bundle.js',
        path: path.resolve(__dirname, 'dist'), // nodeè¯­æ³•ï¼Œ__dirname è·å–å½“å‰æ–‡ä»¶çš„è·¯å¾„
    },

    // ä¸åŒç±»å‹æ¨¡å—çš„å¤„ç†è§„åˆ™
    module: {
        rules: [
            {
                test: /\.vue$/,
                loader: 'vue-loader'
            },
            // å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.js` æ–‡ä»¶
            // ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<script>` å—
            {
                test: /\.js$/,
                loader: 'babel-loader'
            },
            // å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.css` æ–‡ä»¶
            // ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<style>` å— 4.3.0
            {
                test: /\.css$/,
                use: ['vue-style-loader', 'css-loader']
            },
            {
                test: /\.less$/,
                use: ['vue-style-loader', 'css-loader', 'less-loader']
            },
            {
                test: /\.(png|svg|jpg|jpeg|gif)$/,
                loader: 'url-loader',
                options: {
                    name: 'img/[name].[hash:10].[ext]', // æ–‡ä»¶åå­—
                    limit: 5 * 1024, // å¤§å°é™åˆ¶ 5kbï¼Œè¶…å‡ºäº† ç”¨ file-loader å¤„ç†
                    esModule: false, // webpackæ‰“åŒ…å html ä¸­çš„ imgæ ‡ç­¾ çš„ srcå±æ€§æˆäº†[object_Module]
                    // é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŠ è½½å™¨ç”Ÿæˆä½¿ç”¨ES modulesè¯­æ³•çš„JSæ¨¡å—ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½¿ç”¨ESæ¨¡å—æ˜¯æœ‰ç›Šçš„ï¼Œä¾‹å¦‚åœ¨ module concatenation å’Œt ree- shaking çš„æƒ…å†µä¸‹ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å¯ç”¨CommonJSæ¨¡å—è¯­æ³•
                },
            },
        ]
    },
    plugins: [
        // è¯·ç¡®ä¿å¼•å…¥è¿™ä¸ªæ’ä»¶æ¥æ–½å±•é­”æ³•
        new VueLoaderPlugin(),
        new HtmlWebpackPlugin({
            title: 'App',
            // favicon: "./public/favicon.ico", // åœ¨æ­¤å¤„è®¾ç½®
            template: './public/index.html',
        }),
    ]
}
```

### webpack.dev.js

```js
const common = require('./webpack.common.js');
const { merge } = require('webpack-merge');
const { DefinePlugin } = require("webpack");

module.exports = merge(common, {
    // æŒ‡å®šæ‰“åŒ…æ¨¡å¼ å¼€å‘ç¯å¢ƒ
    mode: 'development',
    // æŒ‡å®š source-map
    devtool: 'inline-source-map',
    devServer: {
        port: '5000', // ç«¯å£è®¾ç½®
        contentBase: './dist',
    },
    plugins: [
        new DefinePlugin({
            //å®šä¹‰BASE_URL index.htmlä¸­éœ€è¦ä½¿ç”¨
            BASE_URL: '/public/',
        })
    ]
});
```

### package.json

```json
{
    "name": "vue-app-base",
    "version": "0.1.0",
    "private": true,
    "scripts": {
        "serve": "webpack-dev-server --config webpack.dev.js --open",
        "build": "echo \"è¯·ä½¿ç”¨ Webpack å®ç°æ­¤ä»»åŠ¡\"",
        "lint": "echo \"è¯·ä½¿ç”¨ ESLint å®ç°æ­¤ä»»åŠ¡\""
    },
    "dependencies": {
        "core-js": "^3.6.5",
        "vue": "^2.6.11"
    },
    "devDependencies": {
        "babel-core": "^6.26.3",
        "babel-loader": "^7.1.5",
        "babel-plugin-transform-es2015-modules-commonjs": "^6.26.2",
        "copy-webpack-plugin": "^5.1.2",
        "css-loader": "^3.6.0",
        "file-loader": "^6.2.0",
        "html-webpack-plugin": "^4.5.2",
        "less": "^3.13.1",
        "less-loader": "^7.3.0",
        "url-loader": "^4.1.1",
        "vue-loader": "^15.9.7",
        "vue-style-loader": "^4.1.3",
        "vue-template-compiler": "^2.6.14",
        "webpack": "^4.46.0",
        "webpack-cli": "^3.3.12",
        "webpack-dev-server": "^3.11.2",
        "webpack-merge": "^5.8.0"
    },
    "eslintConfig": {
        "root": true,
        "env": {
            "node": true
        },
        "extends": [
            "plugin:vue/essential",
            "eslint:recommended"
        ],
        "parserOptions": {
            "parser": "babel-eslint"
        },
        "rules": {}
    },
    "browserslist": [
        "> 1%",
        "last 2 versions",
        "not dead"
    ]
}
```

### æµ‹è¯•ğŸŒ°

```cmd
npm run server
```

### â˜…æŠ¥é”™å¤„ç†â˜…

#### 1ã€vue-app-base@0.1.0 serve: `webpack-dev-server --config webpack.dev.js --open`

```cmd
npm ERR! code ELIFECYCLE
npm ERR! errno 1
npm ERR! vue-app-base@0.1.0 serve: `webpack-dev-server --config webpack.dev.js --open`
npm ERR!
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     h:\Node\node_cache\_logs\2021-07-17T11_55_34_473Z-debug.log
```

å¯ä»¥é™æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°†ä¼šçš„å‡ºç°æ‰“å‡ºé”™è¯¯ä¿¡æ¯ï¼ŒæŒ‰éœ€å¤„ç†

```cmd
webpack-dev-server --config webpack.dev.js --open
```

#### 2ã€throw err;Error: Cannot find module 'webpack-merge'

**webpack-merge** ç‰ˆæœ¬é«˜ï¼Œ

å¤„ç†æ–¹æ³•ä¸€ï¼šé™ä½ç‰ˆæœ¬ï¼›

å¤„ç†æ–¹æ³•äºŒï¼š**webpack.dev.js**

```js
const { merge } = require('webpack-merge');
```



## ä¸‰ã€ç”Ÿäº§ç¯å¢ƒé…ç½®

è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦æŠŠèµ„æºæ–‡ä»¶è¿›è¡Œå‹ç¼©ã€æ³¨é‡Šå»é™¤ã€ä»£ç å‹ç¼©ç­‰æ“ä½œ

### å®‰è£…ç›¸å…³çš„åŒ…

```cmd
npm i -D clean-webpack-plugin mini-css-extract-plugin optimize-css-assets-webpack-plugin terser-webpack-plugin postcss-pxtorem@5.1.1 postcss@7.0.36 postcss-cli
```

### webpack.common.js

ä¸åŠ¨

### webpack.prod.js

```js
const { merge } = require('webpack-merge')
const common = require('./webpack.common.js')
const path = require("path")

const { DefinePlugin } = require("webpack")

const HtmlWebpackPlugin = require('html-webpack-plugin')

const CopyWebpackPlugin = require('copy-webpack-plugin')

const { CleanWebpackPlugin } = require("clean-webpack-plugin")

// æå– css åˆ°å•ä¸ªæ–‡ä»¶
const MiniCssExtractPlugin = require("mini-css-extract-plugin");
// ä¼˜åŒ– css æ–‡ä»¶
const OptimizeCSSAssetsPlugin = require("optimize-css-assets-webpack-plugin");
// terser
const TerserPlugin = require("terser-webpack-plugin");

const { VueLoaderPlugin } = require('vue-loader')

module.exports = merge(common, {
    // æ‰“åŒ…æ¨¡å¼:ç”Ÿäº§ç¯å¢ƒ
    mode: 'production',
    //å»é™¤sourceMap
    devtool: "none",

    //è¾“å‡ºçš„æ–‡ä»¶å
    output: {
        // æŒ‡å®šè¾“å‡ºæ–‡ä»¶ç›®å½•
        filename: "js/[name].[hash:8].js",
    },

    module: {
        rules: [
            {
                test: /\.vue$/,
                include: path.resolve(__dirname),
                use: ['vue-loader'],
            },

            {
                test: /\.less$/,
                use: [MiniCssExtractPlugin.loader, "css-loader", "less-loader"],

            },
            {
                test: /\.css$/,
                use: [MiniCssExtractPlugin.loader, "css-loader"],
            },
        ]
    },

    plugins: [
        // new VueLoaderPlugin(),
        // åˆ›å»º HTML æ–‡ä»¶
        new HtmlWebpackPlugin({
            title: 'App', // é¡µé¢æ ‡é¢˜
            template: './public/index.html',
            favicon: "./public/favicon.ico",
            //å¯¹htmlä»£ç è¿›è¡Œå‹ç¼©
            minify: {
                removeComments: true, //å»æ³¨é‡Š
                collapseWhitespace: true, //å‹ç¼©ç©ºæ ¼
                removeAttributeQuotes: true, //å»é™¤å±æ€§å¼•ç”¨
                // keepClosingSlash: true, // ä¿æŒæ ‡ç­¾é—­åˆ
                // removeRedundantAttributes: true, // å»é™¤å†—ä½™å±æ€§
                // removeScriptTypeAttributes: true, // å»é™¤è„šæœ¬ç±»å‹å±æ€§
                // removeStyleLinkTypeAttributes: true, // å»é™¤æ ·å¼é“¾æ¥ç±»å‹å±æ€§
                // useShortDoctype: true // ä½¿ç”¨çŸ­æ–‡æ¡£ç±»å‹
            }
        }),
        // è®¾ç½®å…¨å±€å˜é‡
        new DefinePlugin({
            BASE_URL: process.env.NODE_ENV
        }),
        // æ¸…ç†æ‰“åŒ…æ–‡ä»¶
        new CleanWebpackPlugin(),
        // å¤åˆ¶æ™®é€šæ–‡ä»¶
        new CopyWebpackPlugin(['public']),
        // æŠŠ CSS æå–åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­
        new MiniCssExtractPlugin({
            filename: "css/[name].[hash:10].css",
            chunkFilename: "[id].css"
        })
    ],

    // ä¼˜åŒ–
    optimization: {
        // åŠ¨æ€å¯¼å…¥æ¨¡å—
        splitChunks: {
            chunks: "all"
        },
        // å‹ç¼©
        minimize: true,
        minimizer: [
            // css å‹ç¼©
            new OptimizeCSSAssetsPlugin({
                cssProcessorOptions: {
                    discardComments: { remove: true } // ç§»é™¤æ³¨é‡Š
                }
            }),
            // Terser
            new TerserPlugin({
                parallel: true, // ä½¿ç”¨å¤šè¿›ç¨‹å¹¶è¡Œè¿è¡Œæ¥æé«˜æ„å»ºé€Ÿåº¦
                terserOptions: {
                    warnings: true, // ä¸å±•ç¤º warning
                    compress: {
                        unused: true, // å»é™¤æœªä½¿ç”¨çš„
                        drop_debugger: true, // ç§»é™¤ debugger
                        drop_console: true // å»é™¤ console
                    },
                    module: false,
                }
            })
        ]
    },
});
```

### package.json

````json
{
    "name": "vue-app-base",
    "version": "0.1.0",
    "private": true,
    "scripts": {
        "serve": "webpack-dev-server --config webpack.dev.js --open",
        "build": "webpack --config webpack.prod.js",
        "lint": "echo \"è¯·ä½¿ç”¨ ESLint å®ç°æ­¤ä»»åŠ¡\""
    },
    "dependencies": {
        "core-js": "^3.6.5",
        "vue": "^2.6.11"
    },
    "devDependencies": {
        "babel-core": "^6.26.3",
        "babel-loader": "^7.1.5",
        "babel-plugin-transform-es2015-modules-commonjs": "^6.26.2",
        "clean-webpack-plugin": "^4.0.0-alpha.0",
        "copy-webpack-plugin": "^5.1.2",
        "css-loader": "^3.6.0",
        "file-loader": "^6.2.0",
        "html-webpack-plugin": "^4.5.2",
        "less": "^3.13.1",
        "less-loader": "^7.3.0",
        "mini-css-extract-plugin": "^1.6.0",
        "optimize-css-assets-webpack-plugin": "^6.0.1",
        "postcss": "^8.3.5",
        "postcss-loader": "^4.0.4",
        "postcss-preset-env": "^6.7.0",
        "style-loader": "^1.3.0",
        "terser-webpack-plugin": "^4.2.3",
        "url-loader": "^4.1.1",
        "vue-loader": "^15.9.7",
        "vue-style-loader": "^4.1.3",
        "vue-template-compiler": "^2.6.14",
        "webpack": "^4.46.0",
        "webpack-cli": "^3.3.12",
        "webpack-dev-server": "^3.11.2",
        "webpack-merge": "^5.8.0"
    },
    "eslintConfig": {
        "root": true,
        "env": {
            "node": true
        },
        "extends": [
            "plugin:vue/essential",
            "eslint:recommended"
        ],
        "parserOptions": {
            "parser": "babel-eslint"
        },
        "rules": {}
    },
    "browserslist": [
        "> 1%",
        "last 2 versions",
        "not dead"
    ]
}
````

æµ‹è¯•ğŸŒ°

```cmd
npm run build
```



# 3. EsLint

## ä¸€ã€å®‰è£…ç›¸å…³ä¾èµ–

```cmd
npm i -D eslint 
```



## äºŒã€åˆå§‹åŒ–EsLinté…ç½®æ–‡ä»¶

```cmd
eslint --init
```

é€‰æ‹©ç›¸å…³é…ç½®é€‰é¡¹ï¼Œå®‰è£…å¯¹åº”çš„ä¾èµ–åŒ…

### .eslintrc.js

```js
module.exports = {
  env: {
    browser: true,
    es2021: true
  },
  extends: [
    'plugin:vue/essential',
    'standard'
  ],
  parserOptions: {
    ecmaVersion: 12,
    sourceType: 'module'
  },
  plugins: [
    'vue'
  ],
  rules: {
  }
}
```

### package.js

```cmd
{
    "name": "vue-app-base",
    "version": "0.1.0",
    "private": true,
    "scripts": {
        "serve": "webpack-dev-server --config webpack.dev.js --open",
        "build": "webpack --config webpack.prod.js",
        "lint": "npx eslint ./src/**.js",
        "fix": "npx eslint ./src/**.js --fix"
    },
    "dependencies": {
        "core-js": "^3.6.5",
        "vue": "^2.6.11"
    },
    "devDependencies": {
        "babel-core": "^6.26.3",
        "babel-loader": "^7.1.5",
        "babel-plugin-transform-es2015-modules-commonjs": "^6.26.2",
        "clean-webpack-plugin": "^4.0.0-alpha.0",
        "copy-webpack-plugin": "^5.1.2",
        "css-loader": "^3.6.0",
        "eslint": "^7.31.0",
        "eslint-config-standard": "^16.0.3",
        "eslint-loader": "^4.0.2",
        "eslint-plugin-import": "^2.23.4",
        "eslint-plugin-node": "^11.1.0",
        "eslint-plugin-promise": "^5.1.0",
        "eslint-plugin-standard": "^4.0.1",
        "eslint-plugin-vue": "^7.13.0",
        "file-loader": "^6.2.0",
        "html-webpack-plugin": "^4.5.2",
        "less": "^3.13.1",
        "less-loader": "^7.3.0",
        "mini-css-extract-plugin": "^1.6.0",
        "optimize-css-assets-webpack-plugin": "^6.0.1",
        "postcss": "^8.3.5",
        "postcss-loader": "^4.0.4",
        "postcss-preset-env": "^6.7.0",
        "style-loader": "^1.3.0",
        "terser-webpack-plugin": "^4.2.3",
        "url-loader": "^4.1.1",
        "vue-loader": "^15.9.7",
        "vue-style-loader": "^4.1.3",
        "vue-template-compiler": "^2.6.14",
        "webpack": "^4.46.0",
        "webpack-cli": "^3.3.12",
        "webpack-dev-server": "^3.11.2",
        "webpack-merge": "^5.8.0"
    },
    "eslintConfig": {
        "root": true,
        "env": {
            "node": true
        },
        "extends": [
            "plugin:vue/essential",
            "eslint:recommended"
        ],
        "parserOptions": {
            "parser": "babel-eslint"
        },
        "rules": {}
    },
    "browserslist": [
        "> 1%",
        "last 2 versions",
        "not dead"
    ]
}
```

æµ‹è¯•ğŸŒ°

```cm
npm run lint // è¿›è¡Œæ ¡éªŒæ£€æŸ¥

npm run fix // è¿›è¡Œä¿®æ­£
```



# 4. å¿ƒå¾—

â€‹		ç¬¬ä¸€æ¬¡è‡ªå·±å†™ **wbepack** é…ç½®ï¼Œå‰ä¸¤ä¸‰å¤©å¯¼å‡ºç¢°å£ï¼Œç”±äºæ²¡æœ‰çœ‹å®˜æ–¹çš„ä½¿ç”¨è¯´æ˜ï¼Œåœ¨ç½‘ä¸Šåˆ°å¤„æ‰¾é…ç½®ï¼Œé‡è§å„ç§å¥‡è‘©çš„é”™è¯¯ã€‚åæ¥æ²‰ä¸‹æ–°æ¥æŒ‰ç€å®˜æ–¹çš„é…ç½®è¯´åæ¥è¿›è¡Œå†™é…ç½®ï¼Œå¾ˆå¿«å°±èƒ½å®ç°ç›®æ ‡äº†ã€‚